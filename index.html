<html>

<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>TP Final Simulación</title>
    <link href="node_modules/bootstrap/dist/css/bootstrap.css" rel="stylesheet">
    <link href="src/style.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Roboto+Slab" rel="stylesheet">
    <link href="node_modules/rangeslider.js/dist/rangeslider.css" rel="stylesheet">
    <link href="node_modules/dygraphs/dist/dygraph.css" rel="stylesheet" type="text/css">

</head>

<body>
    <script src="node_modules/jquery/dist/jquery.js"></script>
    <script src="node_modules/rangeslider.js/dist/rangeslider.js"></script>
    <script src="src/rangeslider-script.js"></script>
    <script src="node_modules/d3/dist/d3.js"></script>
    <script src="node_modules/dygraphs/dist/dygraph.js"></script>


    <!-- <script src="https://d3js.org/d3.v4.min.js"></script> -->
    <!-- <script>
        function showConsole(value) {
            console.log(value);
        }
    </script> -->

    <!-- comentario de prueba-->

    <section id="header">
        <div class="row row-title">
            <div class="col">
                <h1 class="title">Calculadora de inversiones</h1>
            </div>
        </div>
        <div class="row row-belowtitle"></div>
    </section>
    <section class="container-fluid">
        <div class="row">
            <div class="col-4">
                <h2 class="alt-title offset-1">Opciones</h2>
                <div class="slider">

                    <div class="row">
                        <div class="col-11 offset-1">
                            <p>Monto a invertir (pesos)</p>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-4 offset-1">
                            <input type="range" min="1000" max="1000000" value="50000" step="1000" data-rangeslider>
                        </div>
                        <div class="col-4">
                            <input type="number" id="monto" class="form-control output cambiar">
                        </div>
                    </div>
                </div>
                <div class="slider">
                    <div class="row">
                        <div class="col-11 offset-1">
                            <p>Plazo de inversiones (meses)</p>
                        </div>

                    </div>
                    <div class="row">
                        <div class="col-4 offset-1">
                            <input type="range" class="" min="1" max="120" value="12" data-rangeslider>
                        </div>
                        <div class="col-4">
                            <input type="number" id="meses" class="form-control output cambiar" onchange="calcular2()">
                        </div>
                    </div>
                </div>

                <div class="row">

                    <div class="col-6 offset-1">
                        <h2 class="alt-title">Alternativas</h2>
                        <p>
                            <input type="checkbox" checked="checked" class="checkbox" id="0" onclick="(new calcular()).change(this)">
                            <label for="0">Dólares</label>
                        </p>
                        <p>
                            <input type="checkbox" class="checkbox " checked="checked" id="1" onclick="calcular().change(this)">
                            <label for="1">LEBAC</label>
                        </p>
                        <p>
                            <input type="checkbox" class="checkbox " checked="checked" id="2" onclick="p.change(this)">
                            <label for="2">Fondos de Inversión</label>
                        </p>
                        <p>
                            <input type="checkbox" class="checkbox " checked="checked" id="3" onclick="calcular(this)">
                            <label for="3">Plazo Fijo</label>
                        </p>

                    </div>
                </div>
                <div class="row">
                    <div class="col-4 offset-2">
                        <p>
                            <button class="btn-primary btn-mati" onclick="calcular2(this)">Calcular</button>
                        </p>

                    </div>
                </div>
                <div class="row">
                    <div class="col-4 offset-2">
                        <p>
                            <button class="btn-primary btn-mati">Crisis!</button>
                        </p>
                        <p>g.visibility() =
                            <span id="visibility"></span>
                        </p>
                    </div>
                </div>
            </div>
            <div class="col800 col-7" id="graph">
                <!-- <svg width="960" height="500"></svg> -->
            </div>
            <!-- <div id="graph"></div> -->
        </div>

    </section>

    <script src="src/graphic.js"></script>
    <script>

        function getFormatedData(dataArray) {
            var dolarHoy = dataArray[0].valor;
            var inversionHoy = $('#monto').val()/dolarHoy;
            console.log(inversionHoy);
            var r = "fecha,valor\n";
            // for (var i = 0; i < dataArray.length; i++) {
                for (var i = 0; i < $('#meses').val()*30; i++) {
                r += dataArray[i].fecha;
                r += "," + inversionHoy*dataArray[i].valor;
                r += "\n";
            }
            return r;
        }


        function calcular2() {
            $.ajax({
                //async: false,
                url: "http://localhost:3000/calcular",
                type: "get",
                contentType: "application/json; charset=utf-8",
                datatype: "json",
                success: function (result) {
                    console.log(result);
                    var enviar = getFormatedData(result);
                    calcular(enviar);
                    // load(result);
                }

            });

        }

    </script>
</body>

</html>